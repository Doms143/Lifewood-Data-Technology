(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function p(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(e){if(e.ep)return;e.ep=!0;const r=p(e);fetch(e.href,r)}})();document.addEventListener("DOMContentLoaded",async function(){if(typeof L>"u"){console.error("❌ Leaflet not loaded.");return}const o=L.map("map",{zoomControl:!0,scrollWheelZoom:!0,doubleClickZoom:!0,minZoom:2,fullscreenControl:!0}).setView([0,25],4);o.fullscreenControl.setPosition("topright");const n=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',maxZoom:18}),p=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles © Esri, USGS, NOAA",maxZoom:18}),s=L.layerGroup([L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"),L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",{attribution:"Hybrid © Esri"})]),e=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"© Esri, Esri Japan, Esri China (Hong Kong)"});n.addTo(o);const r={"🗺️ Map View":n,"🛰️ Satellite View":p,"🌐 Hybrid View":s,"⚪ Light Gray View":e};L.control.layers(r,null,{position:"topright"}).addTo(o);const l=[{name:"South Africa",lat:-30.5595,lon:22.9375,flag:"za"},{name:"Madagascar",lat:-18.7669,lon:46.8691,flag:"mg"},{name:"China",lat:35.8617,lon:104.1954,flag:"cn"},{name:"Hong Kong",lat:22.3193,lon:114.1694,flag:"hk"},{name:"Japan",lat:36.2048,lon:138.2529,flag:"jp"},{name:"Philippines",lat:12.8797,lon:121.774,flag:"ph"},{name:"Vietnam",lat:14.0583,lon:108.2772,flag:"vn"},{name:"Thailand",lat:15.87,lon:100.9925,flag:"th"},{name:"Malaysia",lat:4.2105,lon:101.9758,flag:"my"},{name:"Indonesia",lat:-.7893,lon:113.9213,flag:"id"},{name:"India",lat:20.5937,lon:78.9629,flag:"in"},{name:"Bangladesh",lat:23.685,lon:90.3563,flag:"bd"},{name:"Australia",lat:-25.2744,lon:133.7751,flag:"au"},{name:"Germany",lat:51.1657,lon:10.4515,flag:"de"},{name:"Finland",lat:61.9241,lon:25.7482,flag:"fi"},{name:"United Kingdom",lat:55.3781,lon:-3.436,flag:"gb"},{name:"United States",lat:37.0902,lon:-95.7129,flag:"us"},{name:"Brazil",lat:-14.235,lon:-51.9253,flag:"br"},{name:"Africa",lat:.7893,lon:21.0937,flag:"za"},{name:"Middle East",lat:26.8206,lon:45.0792,flag:"sa"}],u=L.divIcon({className:"custom-pin",html:`
      <div class="pin-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 35" width="25" height="35">
          <path d="M12.5 0C5.6 0 0 5.6 0 12.5C0 19.4 12.5 35 12.5 35S25 19.4 25 12.5C25 5.6 19.4 0 12.5 0Z"
            fill="#f97316" stroke="white" stroke-width="2"/>
          <circle cx="12.5" cy="12.5" r="4" fill="white"/>
        </svg>
      </div>
    `,iconSize:[25,35],iconAnchor:[12.5,35],popupAnchor:[0,-35]}),c=[];let t=null;l.forEach(i=>{const a=L.marker([i.lat,i.lon],{icon:u}).addTo(o);a.bindPopup(`
      <div style="display:flex;align-items:center;gap:8px;">
        <span class="fi fi-${i.flag}"></span>
        <b>${i.name}</b>
      </div>
    `),a.on("mouseover",function(){t!==a&&(this._icon.querySelector(".pin-wrapper").classList.add("hovered"),this.openPopup())}),a.on("mouseout",function(){t!==a&&(this._icon.querySelector(".pin-wrapper").classList.remove("hovered"),this.closePopup())}),a.on("click",()=>{t===a?(t._icon.querySelector(".pin-wrapper").classList.remove("hovered"),t.closePopup(),o.flyToBounds(L.featureGroup(c).getBounds().pad(.1),{duration:1.2}),t=null):(t&&(t._icon.querySelector(".pin-wrapper").classList.remove("hovered"),t.closePopup()),a._icon.querySelector(".pin-wrapper").classList.add("hovered"),a.openPopup(),o.flyTo([i.lat,i.lon],5,{duration:1.2}),t=a)}),c.push(a)});const d=L.featureGroup(c);o.fitBounds(d.getBounds().pad(.1)),o.on("fullscreenchange",function(){setTimeout(()=>{o.invalidateSize(),o.isFullscreen()||o.fitBounds(d.getBounds().pad(.1))},300)}),o.on("click",function(){t&&(t._icon.querySelector(".pin-wrapper").classList.remove("hovered"),t.closePopup(),o.flyToBounds(L.featureGroup(c).getBounds().pad(.1),{duration:1.2}),t=null)})});

